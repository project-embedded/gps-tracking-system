#include <math.h>

uint8_t i, flag, counter, idx;
char c, Lat[12], Lon[12];

void getLatLon(void){
	while(1){
		while(UART7_Read() != '$');
		if(flag) break;
		for(i=0; i<3; i++) c = UART7_Read();
		if(c == 'R'){
			counter = 0;
			for(i=1; i<=5; i++){
				while(UART7_Read() != ',');
				counter++;
		    }
	    }
	}
}

uint16_t calcDist (double x1, double y1, double x2, double y2)
{
	return (uint16_t)(sqrt( pow(x1-x2, 2) + pow(y1-y2, 2) ) );
}

uint16_t dist = 0, on=1;
double x1=0, y1=0, x2=50, y2=40;

int main()
{
  PortA_Init ();
  PortB_Init ();	
  PortF_Init ();
//UART7_Init ();
	
  while(ReadSW() != 0x00)
  {
    dist += calcDist(x1, y1, x2, y2);
    WriteData_B (dist);
    if (dist >= 100)
    {
	    WriteData_A (dist);
	    while(on){
		  RLed();
		  on=0;
	    } 
    }
    x1=x2, y1=y2;
    x2=350, y2=240;
  }
  BLed();
  return 0;
}
